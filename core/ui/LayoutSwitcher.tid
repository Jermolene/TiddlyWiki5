title: $:/snippets/LayoutSwitcher
tags: $:/tags/ControlPanel/Appearance
caption: {{$:/language/ControlPanel/LayoutSwitcher/Caption}}

\whitespace trim
\procedure layouts-filter() [all[tiddlers+shadows]tag[$:/tags/Layout]] [[$:/core/ui/PageTemplate]] +[!is[draft]sort[name]]

\procedure layout-item()
<div class=<<cls>>>
	<$link to={{!!title}}>
		''<$transclude tiddler={{{ [<currentTiddler>get[icon]] }}}/><$transclude field="name"/>''&#32;-&#32;<$transclude field="description"/>
	</$link>
</div>
\end

\procedure input-next-actions(step:1)
\function layouts() [subfilter<layouts-filter>]
<$log layouts=<<layouts>> bbb="bbb" />
<$action-sendmessage $message="tm-navigate" $param={{{[<layouts>cycle<layouts>,<step>]}}}/>
\end

<$linkcatcher to="$:/layout">
	<$keyboard key="((input-up))" actions=<<input-next-actions>>>
		<$keyboard key="((input-down))" actions=<<input-next-actions "-1">>>
			<div class="tc-chooser">
				<$list filter=<<layouts-filter>>>
					<% if [{$:/layout}has[text]] %>
						<$set name="cls" filter="[all[current]field:title{$:/layout}]" value="tc-chooser-item tc-chosen" emptyValue="tc-chooser-item">
							<<layout-item>>
						</$set>
					<% else %>
						<$set name="cls" filter="[all[current]field:title[$:/core/ui/PageTemplate]]" value="tc-chooser-item tc-chosen" emptyValue="tc-chooser-item">
							<<layout-item>>
						</$set>
					<% endif %>
				</$list>
			</div>
		</$keyboard>
	</$keyboard>
</$linkcatcher>
